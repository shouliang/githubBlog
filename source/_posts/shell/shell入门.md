title: shell入门(1)
date: 2014-07-05 14:45:23
tags: [Shell]
---
## shell简介

Shell本身是一个用C语言编写的程序，它是用户使用Unix/Linux的桥梁，用户的大部分工作都是通过Shell完成的。Shell既是一种命令语言，又是一种程序设计语言。作为命令语言，它交互式地解释和执行用户输入的命令；作为程序设计语言，它定义了各种变量和参数，并提供了许多在高级语言中才具有的控制结构，包括循环和分支。

它虽然不是Unix/Linux系统内核的一部分，但它调用了系统核心的大部分功能来执行程序、建立文件并以并行的方式协调各个程序的运行。因此，对于用户来说，shell是最重要的实用程序，深入了解和熟练掌握shell的特性极其使用方法，是用好Unix/Linux系统的关键。

可以说，shell使用的熟练程度反映了用户对Unix/Linux使用的熟练程度。

Shell有两种执行命令的方式：

* 交互式（Interactive）：解释执行用户的命令，用户输入一条命令，Shell就解释执行一条。
* 批处理（Batch）：用户事先写一个Shell脚本(Script)，其中有很多条命令，让Shell一次把这些命令执行完，而不必一条一条地敲命令。

Shell脚本和编程语言很相似，也有变量和流程控制语句，但Shell脚本是解释执行的，不需要编译，Shell程序从脚本中一行一行读取并执行这些命令，相当于一个用户把脚本中的命令一行一行敲到Shell提示符下执行。

Unix/Linux上常见的Shell脚本解释器有bash、sh、csh、ksh等，习惯上把它们称作一种Shell。我们常说有多少种Shell，其实说的是Shell脚本解释器。由于bash是最常见的脚本解释器，如无特殊说明，shell默认都是bash shell。

注意：bash是linux标准的默认shell，bash完全兼容sh，也就是说，用sh写的脚本可以不加修改的在bash中执行。

## 什么时候使用shell
因为Shell是各UNIX系统之间通用的功能，并且经过了POSIX的标准化。因此，Shell脚本只要“用心写”一次，即可应用到很多系统上。因此，之所以要使用Shell脚本是基于：

* 简单性：Shell是一个高级语言；通过它，你可以简洁地表达复杂的操作。
* 可移植性：使用POSIX所定义的功能，可以做到脚本无须修改就可在不同的系统上执行。
* 开发容易：可以在短时间内完成一个功能强大又实用的脚本。

但是，考虑到Shell脚本的命令限制和效率问题，下列情况一般不使用Shell：

1. 资源密集型的任务，尤其在需要考虑效率时（比如，排序，hash等等）。
2. 需要处理大任务的数学操作，尤其是浮点运算，精确运算，或者复杂的算术运算（这种情况一般使用C++或FORTRAN 来处理）。
3. 有跨平台（操作系统）移植需求（一般使用C 或Java）。
4. 复杂的应用，在必须使用结构化编程的时候（需要变量的类型检查，函数原型，等等）。
5. 对于影响系统全局性的关键任务应用。
6. 对于安全有很高要求的任务，比如你需要一个健壮的系统来防止入侵、破解、恶意破坏等等。
7. 项目由连串的依赖的各个部分组成。
8. 需要大规模的文件操作。 需要多维数组的支持。
9. 需要数据结构的支持，比如链表或数等数据结构。
10. 需要产生或操作图形化界面 GUI。
11. 需要直接操作系统硬件。
12. 需要 I/O 或socket 接口。
13. 需要使用库或者遗留下来的老代码的接口。
14. 私人的、闭源的应用（shell 脚本把代码就放在文本文件中，全世界都能看到）。
如果你的应用符合上边的任意一条，那么就考虑一下更强大的语言吧——或许是Perl、Tcl、Python、Ruby——或者是更高层次的编译语言比如C/C++，或者是Java。即使如此，你会发现，使用shell来原型开发你的应用，在开发步骤中也是非常有用的。

## 第一个shell脚本
打开文本编辑器vim，新建一个文件test，扩展名为sh（sh代表shell），全名是test.sh。扩展名并不影响脚本执行，见名知意就好，如果你用 php 写shell 脚本，扩展名就用 php 好了。

输入一些代码：
```
#!/bin/sh
#echo "123456"
echo "Hello World !"
```
第一行“#!” 是一个约定的标记，它告诉系统这个脚本需要什么解释器来执行，即使用哪一种Shell。通常/bin/sh是指向/bin/bash的。
但后面的字符 # 表示注释，#后面的内容将被忽略。
echo命令用于向窗口输出文本。

运行Shell脚本有两种方法。

### 作为可执行程序
将上面的代码保存为test.sh，并 cd 到相应目录：
```
$ chmod +x ./test.sh  #使脚本具有执行权限
$ ./test.sh  #执行脚本
Hello World !
```

注意，一定要写成./test.sh，而不是test.sh。运行其它二进制的程序也一样，直接写test.sh，linux系统会去PATH里寻找有没有叫test.sh的，而只有/bin, /sbin, /usr/bin，/usr/sbin等在PATH里，你的当前目录通常不在PATH里，所以写成test.sh是会找不到命令的，要用./test.sh告诉系统说，就在当前目录找。
通过这种方式运行bash脚本，第一行一定要写对，好让系统查找到正确的解释器。

###作为解释器参数

这种运行方式是，直接运行解释器，其参数就是shell脚本的文件名，如：
```
$ /bin/sh test.sh
$ /bin/php test.php
```
这种方式运行的脚本，不需要在第一行指定解释器信息，写了也没用。

再看一个例子。下面的脚本使用 read 命令从 stdin 获取输入并赋值给 PERSON 变量，最后在 stdout 上输出：
```
#!/bin/bash
# Author : shouliang
echo "What is your name?"
read PERSON
echo "Hello, $PERSON"
```
运行脚本：
```
$ chmod +x ./test.sh
$ ./test.sh
What is your name?
shouliang
Hello, shouliang
```
